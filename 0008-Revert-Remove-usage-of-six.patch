From 2a5e2781be5f7bdbe45011d3118d918327f5b5af Mon Sep 17 00:00:00 2001
From: Martin Kopec <mkopec@redhat.com>
Date: Wed, 25 Aug 2021 10:42:12 +0000
Subject: [PATCH 08/15] Revert "Remove usage of six"

This reverts commit 0fa20695101bb037a79e1dc3db34c7b644e9c142.
---
 tempest/lib/common/ssh.py           | 3 +--
 tempest/tests/cmd/test_workspace.py | 5 ++++-
 tempest/tests/lib/test_ssh.py       | 5 +++--
 tools/check_logs.py                 | 3 +--
 4 files changed, 9 insertions(+), 7 deletions(-)

diff --git a/tempest/lib/common/ssh.py b/tempest/lib/common/ssh.py
index ee1537542..b204edd6d 100644
--- a/tempest/lib/common/ssh.py
+++ b/tempest/lib/common/ssh.py
@@ -14,7 +14,6 @@
 #    under the License.
 
 
-import io
 import select
 import socket
 import time
@@ -67,7 +66,7 @@ class Client(object):
         self.password = password
         if isinstance(pkey, str):
             pkey = paramiko.RSAKey.from_private_key(
-                io.StringIO(str(pkey)))
+                six.StringIO(str(pkey)))
         self.pkey = pkey
         self.look_for_keys = look_for_keys
         self.key_filename = key_filename
diff --git a/tempest/tests/cmd/test_workspace.py b/tempest/tests/cmd/test_workspace.py
index f16d53396..eae620224 100644
--- a/tempest/tests/cmd/test_workspace.py
+++ b/tempest/tests/cmd/test_workspace.py
@@ -12,12 +12,15 @@
 # License for the specific language governing permissions and limitations
 # under the License.
 
-from io import StringIO
 import os
 import shutil
 import subprocess
 import tempfile
 from unittest.mock import patch
+try:
+    from StringIO import StringIO
+except ImportError:
+    from io import StringIO
 
 from tempest.cmd import workspace
 from tempest.lib.common.utils import data_utils
diff --git a/tempest/tests/lib/test_ssh.py b/tempest/tests/lib/test_ssh.py
index f04db398c..f3bc63d2c 100644
--- a/tempest/tests/lib/test_ssh.py
+++ b/tempest/tests/lib/test_ssh.py
@@ -12,10 +12,11 @@
 #    License for the specific language governing permissions and limitations
 #    under the License.
 
-from io import StringIO
 import socket
 from unittest import mock
 
+import six
+from six import StringIO
 import testtools
 
 from tempest.lib.common import ssh
@@ -29,7 +30,7 @@ class TestSshClient(base.TestCase):
     SELECT_POLLIN = 1
 
     @mock.patch('paramiko.RSAKey.from_private_key')
-    @mock.patch('io.StringIO')
+    @mock.patch('six.StringIO')
     def test_pkey_calls_paramiko_RSAKey(self, cs_mock, rsa_mock):
         cs_mock.return_value = mock.sentinel.csio
         pkey = 'mykey'
diff --git a/tools/check_logs.py b/tools/check_logs.py
index 8ab3af2be..41032acd4 100755
--- a/tools/check_logs.py
+++ b/tools/check_logs.py
@@ -17,7 +17,6 @@
 
 import argparse
 import gzip
-import io
 import os
 import re
 import sys
@@ -69,7 +68,7 @@ def process_files(file_specs, url_specs, allow_lists):
         req = urlreq.Request(url)
         req.add_header('Accept-Encoding', 'gzip')
         page = urlreq.urlopen(req)
-        buf = io.StringIO(page.read())
+        buf = six.StringIO(page.read())
         f = gzip.GzipFile(fileobj=buf)
         if scan_content(f.read().splitlines(), regexp, allow_list):
             logs_with_errors.append(name)
-- 
2.27.0

